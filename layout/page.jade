extends partial/layout

block container
  include mixins/widget
  +picbar()
  section.index-content(class="#{ page.pname }")
    != page.content.replace(/<br>/g,'')

block scripts
  script(type="text/javascript").
    getLocation()
  if page.function == "log-analyse"
    script(type="text/javascript").
      getGALogFile()
  if page.pname == "mylinks"
    script(type="text/javascript").
      randomTags("showall") 
  if page.pname == "puzzle"
    script(src='https://technotarek.com/timeliner/js/vendor/venobox/venobox.min.js')
    script(type="text/javascript").
      $(document).ready(function() {
        puzzle = new Puzzles("all")
        $(document).on('click','p.editanswer',
          function(){
            var ele = $(this);
            var text = ele.text();
            var placeholder= ele.attr("placeholder")
            if (text ==  placeholder){
              ele.html("")
            }
          }
        );
        $(document).on('blur','p.editanswer',
          function(){
            var ele = $(this);
            var text = ele.text();
            var placeholder= ele.attr("placeholder")
            if (text ==  ''){
              ele.html(placeholder)
            }else{
              puzzle.savePuzzleAnswer(ele.closest('div.timeline-wrapper').attr("data-date"),ele.closest('dl.timeline-series').attr("data-time"),text);
            }
          }
        );
        $(document).on('click','dt.timeline-event span',function(e){
          e.stopPropagation();
          e.preventDefault();
          var ele = $(this)
          var status = ""
          if(ele.closest('dl.timeline-series').hasClass("check")){
            status = "ongoing"
            ele.closest('dl.timeline-series').removeClass("check").addClass("ongoing")
          }else{
            status = "check"
            ele.closest('dl.timeline-series').removeClass("ongoing").addClass("check")
          }
          puzzle.updatePuzzleStatus(ele.closest('div.timeline-wrapper').attr("data-date"),ele.closest('dl.timeline-series').attr("data-time"),status);
        });
        $.timeliner({});
        $('.venobox').venobox();
      });


